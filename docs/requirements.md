# 院内チャットツール 要件定義書

## 1. プロダクト概要

### 1.1 目的

院内スタッフ間のコミュニケーション効率化を目的とした、患者ごとのトークルーム機能を持つリアルタイムチャットツール

### 1.2 導入形式

- **院内スマホがある場合**: スマホにアプリをインストール
- **院内スマホがない場合**: オンプレミスパソコンに導入、VPN 経由でクラウドホスティング

### 1.3 利用環境

- 院内ネットワーク限定での利用
- 外部ネットワークからのアクセスは想定しない
- 病院の VPN/院内ネットワーク経由でのみアクセス可能

## 2. 基本機能（必須機能）

### 2.1 患者ごとのトークルーム

- **機能**: 患者ごとに専用のチャットルームを作成
- **参加者**: 患者に関わる以下のスタッフが自動参加
  - 担当看護師
  - 担当医
  - 受け持ち医
  - 薬剤師
  - ケアマネージャー
- **通信方式**: テキストベースのリアルタイムチャット

### 2.2 メンション機能

- **機能**: @マークを使用して特定のスタッフにメンションを送信
- **対象**: 医師、看護師、その他院内スタッフ
- **通知**: メンション受信時に特別な通知を表示

### 2.3 通知機能

#### スマホ版

- 各トークルームの新規メッセージ数をバッジ表示
- バイブレーション通知
- メンション専用通知

#### PC 版

- ログイン時に新規通知を画面表示
- リアルタイム通知ポップアップ

## 3. 拡張機能（More 機能）

### 3.1 ToDo リストの AI 自動作成

- **機能**: メッセージ内容を解析して ToDo リストを自動生成
- **AI**: Claude API 等を使用
- **表示**: 専用 UI で ToDo リストを管理

### 3.2 メンバーの自動登録・アーカイブ

#### 自動登録

- 電子カルテシステムとの連携
- 受け持ち医、主治医、担当看護師の登録情報を自動同期
- チャンネルへの自動参加

#### 自動アーカイブ

- 退院患者のチャンネルを自動アーカイブ
- データは保持（削除しない）
- アーカイブ済みチャンネルは別セクションで表示

### 3.3 多様な送信形式

- **基本**: テキスト、ファイル、写真
- **拡張**: Notion 風の以下の機能
  - ToDo リスト送信
  - ページ送信
  - 構造化されたコンテンツ

## 4. 技術仕様

### 4.1 開発方針

- **初期段階**: PC 用 Web アプリに特化
- **将来拡張**: スマホアプリ（React Native 等）
- **マルチプラットフォーム**: 初期段階では対応しない

### 4.2 技術スタック

- **フロントエンド**: React/Next.js
- **バックエンド**: Node.js/Next.js API Routes
- **データベース**: PostgreSQL + Prisma
- **リアルタイム通信**: WebSocket
- **認証**: NextAuth.js
- **AI**: Claude API

### 4.3 セキュリティ

#### MVP 段階

- 簡易ログイン機能（ChatGPT 程度）
- デモ/プロトタイプレベルのセキュリティ

#### 本格導入時

- 院内 VPN 連携
- 厳格な認証・認可システム
- 通信暗号化

## 5. MVP（Ver.0.1）要件

### 5.1 必須機能

1. **患者ごとのトークルーム**
   - サイドバーに患者一覧表示
   - クリックで画面切り替え
2. **リアルタイムメッセージング**
   - テキストメッセージの送受信
   - 即座の画面更新
3. **通知機能**
   - 新規メッセージの通知表示
   - 未読件数の表示

### 5.2 デモ要件

- **対象**: 営業プレゼンテーション用
- **環境**: ローカル環境で動作
- **参加者**: 2 名のパソコンでの動作確認
- **確認項目**:
  - メッセージ送受信
  - チャンネル通知
  - サイドバーでの患者チャンネル切り替え

### 5.3 UI 要件

- Discord 風のインターフェース
- 用件ごとのスレッド機能
- シンプルで直感的な操作性
- まず「仕組み」の動作を優先

## 6. 開発体制

### 6.1 役割分担

- **津村**: PC 向け Web チャットツールの開発（仕組み作り）
- **吉田**: UI デザイン（見た目の方向性）
- **その他メンバー**:
  - 機能・UI フィードバック
  - 資料作成
  - フィードバック反映

### 6.2 開発フェーズ

1. **Phase 1**: MVP 開発（基本チャット機能）
2. **Phase 2**: 拡張機能実装（AI、自動化）
3. **Phase 3**: セキュリティ強化・本格導入
4. **Phase 4**: スマホアプリ開発

## 7. 将来の拡張可能性

### 7.1 プラットフォーム拡張

- PWA 化によるスマホ対応
- React Native でのネイティブアプリ
- Electron でのデスクトップアプリ

### 7.2 機能拡張

- 電子カルテシステム連携
- 音声・ビデオ通話機能
- ファイル共有・管理機能
- 勤務シフト連携
- 緊急時アラート機能
